# ü§ñ KlarVPN - Telegram-–±–æ—Ç –¥–ª—è Remnawave

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –Ω–∞ –ø–∞–Ω–µ–ª—å **Remnawave** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.

![Python](https://img.shields.io/badge/Python-3.11+-blue?logo=python) ![Aiogram](https://img.shields.io/badge/Aiogram-3.x-00ACEE?logo=telegram) ![PostgreSQL](https://img.shields.io/badge/PostgreSQL-asyncpg-336791?logo=postgresql) ![Docker](https://img.shields.io/badge/Docker-Compose-2496ED?logo=docker)

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

**–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- üåç –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (—Ä—É—Å—Å–∫–∏–π, –∞–Ω–≥–ª–∏–π—Å–∫–∏–π)
- üì± –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–¥–ø–∏—Å–∫–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- üéÅ –ü—Ä–æ–±–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏, –ø—Ä–æ–º–æ–∫–æ–¥—ã –∏ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞
- üí≥ –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ YooKassa, FreeKassa, CryptoPay, Telegram Stars, Tribute
- üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:**
- üìà –ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
- üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏
- üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ø–∞–Ω–µ–ª—å—é Remnawave
- üéüÔ∏è –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- üîê –ó–∞—â–∏—â–µ–Ω–Ω–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker & Docker Compose
- –ü–∞–Ω–µ–ª—å Remnawave —Å API –¥–æ—Å—Ç—É–ø–æ–º
- –¢–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞
- –î–∞–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   ```bash
   git clone https://github.com/NexusQX/TelegramBot.git
   cd TelegramBot
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
   ```bash
   cp .env.example .env
   nano .env  # –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
   ```

   **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
   - `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞
   - `ADMIN_IDS` ‚Äî ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
   - `WEBHOOK_BASE_URL` ‚Äî –±–∞–∑–æ–≤—ã–π URL –¥–ª—è –≤–µ–±—Ö—É–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://your.domain.com`)
   - `PANEL_API_URL` & `PANEL_API_KEY` ‚Äî –¥–æ—Å—Ç—É–ø –∫ –ø–∞–Ω–µ–ª–∏

   <details>
   <summary><b>–í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è</b></summary>

   | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ |
   |-----------|-----------|---------|
   | **–û—Å–Ω–æ–≤–Ω—ã–µ** | `BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞ |
   | | `ADMIN_IDS` | ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é) |
   | | `DEFAULT_LANGUAGE` | –Ø–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`ru`/`en`) |
   | **–°—Å—ã–ª–∫–∏** | `WEBHOOK_BASE_URL` | –ë–∞–∑–æ–≤—ã–π URL –≤–µ–±—Ö—É–∫–æ–≤ |
   | | `SUPPORT_LINK` | –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É |
   | | `REQUIRED_CHANNEL_ID` | ID –∫–∞–Ω–∞–ª–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏ |
   | | `REQUIRED_CHANNEL_LINK` | –ü—É–±–ª–∏—á–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª |
   | **–í–µ–±—Å–µ—Ä–≤–µ—Ä** | `WEB_SERVER_HOST` | –•–æ—Å—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `0.0.0.0`) |
   | | `WEB_SERVER_PORT` | –ü–æ—Ä—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `8080`) |
   | **YooKassa** | `YOOKASSA_ENABLED` | –í–∫–ª—é—á–∏—Ç—å YooKassa |
   | | `YOOKASSA_SHOP_ID` | ID –º–∞–≥–∞–∑–∏–Ω–∞ |
   | | `YOOKASSA_SECRET_KEY` | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á |
   | | `YOOKASSA_AUTOPAYMENTS_ENABLED` | –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Å–ø–∏—Å–∞–Ω–∏—è |
   | **FreeKassa** | `FREEKASSA_ENABLED` | –í–∫–ª—é—á–∏—Ç—å FreeKassa |
   | | `FREEKASSA_MERCHANT_ID` | ID –º–∞–≥–∞–∑–∏–Ω–∞ |
   | | `FREEKASSA_API_KEY` | API-–∫–ª—é—á |
   | | `FREEKASSA_SECOND_SECRET` | –°–µ–∫—Ä–µ—Ç–Ω–æ–µ —Å–ª–æ–≤–æ ‚Ññ2 |
   | **CryptoPay** | `CRYPTOPAY_ENABLED` | –í–∫–ª—é—á–∏—Ç—å CryptoPay |
   | | `CRYPTOPAY_TOKEN` | –¢–æ–∫–µ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
   | **Telegram Stars** | `STARS_ENABLED` | –í–∫–ª—é—á–∏—Ç—å Telegram Stars |
   | **Tribute** | `TRIBUTE_ENABLED` | –í–∫–ª—é—á–∏—Ç—å Tribute |
   | **–ü–∞–Ω–µ–ª—å** | `PANEL_API_URL` | URL API –ø–∞–Ω–µ–ª–∏ |
   | | `PANEL_API_KEY` | API-–∫–ª—é—á –ø–∞–Ω–µ–ª–∏ |
   | | `PANEL_WEBHOOK_SECRET` | –°–µ–∫—Ä–µ—Ç –¥–ª—è –≤–µ–±—Ö—É–∫–æ–≤ –ø–∞–Ω–µ–ª–∏ |
   | | `USER_SQUAD_UUIDS` | ID –æ—Ç—Ä—è–¥–æ–≤ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
   | | `USER_TRAFFIC_LIMIT_GB` | –õ–∏–º–∏—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ (0 = –±–µ–∑–ª–∏–º–∏—Ç) |
   | **–ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥** | `TRIAL_ENABLED` | –í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ |
   | | `TRIAL_DURATION_DAYS` | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –¥–Ω—è—Ö |
   | | `TRIAL_TRAFFIC_LIMIT_GB` | –õ–∏–º–∏—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –ø—Ä–æ–±–∫–∏ |

   –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. `.env.example`

   </details>

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:**
   ```bash
   docker compose up -d
   ```

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–µ–±—Ö—É–∫–∏:**
   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏ (Nginx) –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
   ```
   https://<–≤–∞—à_–¥–æ–º–µ–Ω>/webhook/yookassa ‚Üí http://remnawave-tg-shop:8080/webhook/yookassa
   https://<–≤–∞—à_–¥–æ–º–µ–Ω>/webhook/freekassa ‚Üí http://remnawave-tg-shop:8080/webhook/freekassa
   https://<–≤–∞—à_–¥–æ–º–µ–Ω>/webhook/cryptopay ‚Üí http://remnawave-tg-shop:8080/webhook/cryptopay
   https://<–≤–∞—à_–¥–æ–º–µ–Ω>/webhook/tribute ‚Üí http://remnawave-tg-shop:8080/webhook/tribute
   https://<–≤–∞—à_–¥–æ–º–µ–Ω>/webhook/panel ‚Üí http://remnawave-tg-shop:8080/webhook/panel
   https://<–≤–∞—à_–¥–æ–º–µ–Ω>/<BOT_TOKEN> ‚Üí http://remnawave-tg-shop:8080/webhook/telegram
   ```

5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
   ```bash
   docker compose logs -f remnawave-tg-shop
   ```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ bot/                    # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ filters/            # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ handlers/           # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ –∫–æ–ª–±—ç–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ keyboards/          # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/        # i18n, –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–Ω–∞, etc.
‚îÇ   ‚îú‚îÄ‚îÄ services/           # –ü–ª–∞—Ç–µ–∂–∏, API –ø–∞–Ω–µ–ª–∏, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ states/             # FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ main_bot.py         # –Ø–¥—Ä–æ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ config/                 # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Pydantic
‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îú‚îÄ‚îÄ dal/                # –°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
‚îÇ   ‚îú‚îÄ‚îÄ models.py           # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ database_setup.py   # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îú‚îÄ‚îÄ locales/                # –§–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (ru, en)
‚îú‚îÄ‚îÄ docker-compose.yml      # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ Dockerfile              # –û–±—Ä–∞–∑ Docker
‚îî‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Python 3.11** ‚Äî —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **Aiogram 3.x** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram
- **SQLAlchemy 2.x** + **asyncpg** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å PostgreSQL
- **aiohttp** ‚Äî –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –≤–µ–±—Ö—É–∫–æ–≤
- **Pydantic** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **Docker** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

---

## üê≥ Docker

–û–±—Ä–∞–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ GitHub Container Registry –∏ Docker Hub —á–µ—Ä–µ–∑ GitHub Actions.

–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Docker Hub:
1. –î–æ–±–∞–≤—å—Ç–µ –≤ Secrets —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: `DOCKERHUB_USERNAME` –∏ `DOCKERHUB_TOKEN`
2. –ò–ª–∏ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ `build: .` –≤ `docker-compose.yml` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–±–æ—Ä–∫–∏

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
docker compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker compose logs -f remnawave-tg-shop

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –±–æ—Ç–∞
docker compose restart remnawave-tg-shop

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
docker compose down

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–æ–π –æ–±—Ä–∞–∑–∞
docker compose up -d --build
```

---

## üîÆ –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ

- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ (—Å–∫–∏–¥–∫–∏ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö)
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

---

**–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?** –ö–æ–Ω—Ç–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∫—É —á–µ—Ä–µ–∑ —Å—Å—ã–ª–∫—É –≤ –±–æ—Ç–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ Issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
